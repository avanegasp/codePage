<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Codepad</title>

  <link rel="stylesheet" href="lib/codemirror.css">
  <link rel="stylesheet" href="theme/dracula.css">

</head>
<body>
  <section>
    <h1>CODEPAD</h1>
    <button id="btn-github">Ingresa con Github</button>
  </section>

  <script src="lib/codemirror.js"></script>
  <script src="mode/javascript/javascript.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.2.0/firebase.js"></script>
  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyDUhOJ0Zt-KUDMtiCjNt4E3qybHQndm3fE",
      authDomain: "codepad-75be6.firebaseapp.com",
      databaseURL: "https://codepad-75be6.firebaseio.com",
      projectId: "codepad-75be6",
      storageBucket: "",
      messagingSenderId: "135663807027"
    };
    firebase.initializeApp(config);


        // INGRESO CON GITHUB
    function ingresoGithub(e){
      e.preventDefault();
      alert('entro a ingresoGithub')
      if(!firebase.auth().currentUser){ // Debo saber si mi usuario ha ingresado,
        alert('entro a autenticarse')
        var provider = new firebase.auth.GithubAuthProvider(); // Si no ha ingresado Gitub es mi proveedor

        // provider.addScope('https://avanegasp.github.io/codepage/'); // debo pasar mi URL (es mi sistema de autentificación)

        firebase.auth().signInWithRedirect(provider);
        alert('provider')
      }else{
        console.log('ya esta autenticado')
        firebase.auth().signOut;
      }
    };

    document.getElementById('btn-github').addEventListener('click',ingresoGithub);


    firebase.auth().getRedirectResult().then(function(result) {
      firebase.auth().onAuthStateChanged(function(user){
        console.log(user)
      })
      console.log(result)
      // alert('reedireccionó')
      // if (result.credential) {
      //     alert('credencial')
      //   var token = result.credential.accessToken;
      // }
      // var user = result.user;
    }).catch(function(error) {
      var errorCode = error.code;
      var errorMessage = error.message;
      var email = error.email;
      var credential = error.credential;
    });

  </script>
</body>
</html>
